# ğŸ“‹ ä¾›åº”å•†èµ„æ–™ç®¡ç†æ¨¡å—é‡æ„æ–¹æ¡ˆ

**åˆ›å»ºæ—¶é—´**: 2025-12-04  
**ç‰ˆæœ¬**: v1.0  
**åŸºäº**: CLAUDE.md AIåä½œå¼€å‘é€šç”¨åŸåˆ™

---

## ğŸ” ç°å­˜é—®é¢˜åˆ†æ

### 1. **ä»£ç ç»“æ„é—®é¢˜** ğŸš¨ é«˜ä¼˜å…ˆçº§

#### é—®é¢˜æè¿°
- **å•ä¸€æ–‡ä»¶è¿‡å¤§**: 2550è¡Œä»£ç ï¼Œè¿åCLAUDE.mdä¸­"å½“å•æ–‡ä»¶è¶…è¿‡500è¡Œæ—¶å¼ºåˆ¶è§¦å‘é‡æ„æ‹†åˆ†"çš„åŸåˆ™
- **ä¸Šå¸å¯¹è±¡**: `SupplierDocumentManager`ç±»æ‰¿æ‹…äº†å¤ªå¤šèŒè´£ï¼ˆæ•°æ®ç®¡ç†ã€UIæ¸²æŸ“ã€äº‹ä»¶å¤„ç†ã€æ¨¡æ€æ¡†ç®¡ç†ã€é‚®ä»¶ç”Ÿæˆç­‰ï¼‰
- **æ–¹æ³•è¿‡å¤š**: 17ä¸ªå¼‚æ­¥æ–¹æ³• + å¤šä¸ªæ¸²æŸ“æ–¹æ³•ï¼ŒèŒè´£è¾¹ç•Œä¸æ¸…

#### å…·ä½“è¡¨ç°
```javascript
// å½“å‰supplier.jsåŒ…å«çš„æ‰€æœ‰èŒè´£ï¼š
class SupplierDocumentManager {
  // æ•°æ®ç®¡ç† (4ä¸ªæ–¹æ³•)
  async loadSummary() { /* ... */ }
  async loadDetails() { /* ... */ }
  async refresh() { /* ... */ }
  
  // UIæ¸²æŸ“ (4ä¸ªæ–¹æ³•)  
  render() { /* ... */ }
  renderSupplierRow() { /* ... */ }
  renderSupplierDetails() { /* ... */ }
  
  // äº‹ä»¶å¤„ç† (å¤æ‚çš„äº‹ä»¶å§”æ‰˜)
  bindEvents() { /* 300+è¡Œå¤æ‚é€»è¾‘ */ }
  
  // æ¨¡æ€æ¡†ç®¡ç† (8ä¸ªæ–¹æ³•)
  showUploadModal() { /* ... */ }
  hideUploadModal() { /* ... */ }
  showEditModal() { /* ... */ }
  // ... æ›´å¤šæ¨¡æ€æ¡†æ–¹æ³•
  
  // é‚®ä»¶æœåŠ¡ (3ä¸ªæ–¹æ³•)
  async generateSingleEmail() { /* ... */ }
  async generateBatchEmail() { /* ... */ }
  async copyEmailContent() { /* ... */ }
  
  // æ–‡ä»¶æ“ä½œ (4ä¸ªæ–¹æ³•)
  async submitUpload() { /* ... */ }
  async deleteDocument() { /* ... */ }
  async openLocalFolder() { /* ... */ }
  
  // ç‰©æ–™ç®¡ç† (3ä¸ªæ–¹æ³•)
  async submitAddMaterial() { /* ... */ }
  async deleteMaterial() { /* ... */ }
  async syncSuppliersFromIQC() { /* ... */ }
}
```

### 2. **è°ƒè¯•ä»£ç æ±¡æŸ“** ğŸš¨ é«˜ä¼˜å…ˆçº§

#### é—®é¢˜æè¿°
- **149ä¸ªconsoleè¯­å¥**: ä¸¥é‡è¿åç”Ÿäº§ç¯å¢ƒä»£ç è§„èŒƒ
- **10ä¸ªå…¨å±€æµ‹è¯•å‡½æ•°**: `window.testXXX`æ±¡æŸ“å…¨å±€å‘½åç©ºé—´
- **è°ƒè¯•ä¿¡æ¯æ³„éœ²**: åŒ…å«è¯¦ç»†çš„å†…éƒ¨çŠ¶æ€ä¿¡æ¯

#### å…·ä½“ç»Ÿè®¡
```javascript
// consoleè¯­å¥ç»Ÿè®¡ï¼š
console.log: 120ä¸ª
console.warn: 15ä¸ª  
console.error: 14ä¸ª

// å…¨å±€æµ‹è¯•å‡½æ•°ï¼š
window.testSupplierManager()
window.testDocumentAPI()
window.testModals()
window.forceShowUploadModal()
window.checkModal()
window.testDatabaseConnection()
window.testMaterialOperations()
// ... ç­‰10ä¸ªæµ‹è¯•å‡½æ•°
```

### 3. **é…ç½®ç¡¬ç¼–ç ** ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

#### é—®é¢˜æè¿°
- **APIç«¯ç‚¹ç¡¬ç¼–ç **: `/api/suppliers/summary`ç­‰è·¯å¾„æ•£å¸ƒåœ¨ä»£ç ä¸­
- **é­”æ³•æ•°å­—**: æ–‡ä»¶å¤§å°é™åˆ¶10MBã€è¶…æ—¶æ—¶é—´ç­‰
- **çŠ¶æ€ç æ˜ å°„**: ç¼ºå°‘ç»Ÿä¸€çš„é”™è¯¯ç ç®¡ç†

#### å…·ä½“ç¤ºä¾‹
```javascript
// ç¡¬ç¼–ç çš„APIç«¯ç‚¹
const response = await fetch('/api/suppliers/summary', { /* ... */ });
const response = await fetch(`/api/suppliers/${supplierId}/details`, { /* ... */ });

// é­”æ³•æ•°å­—
if (file.size > 10 * 1024 * 1024) { /* 10MBé™åˆ¶ */ }
setTimeout(() => { /* è¶…æ—¶å¤„ç† */ }, 5000);

// ç¡¬ç¼–ç çŠ¶æ€æ˜ å°„
if (status === 'normal') { /* ğŸŸ¢ æ­£å¸¸ */ }
if (status === 'warning') { /* ğŸŸ¡ å³å°†åˆ°æœŸ */ }
```

### 4. **ç¼“å­˜ç­–ç•¥æ··ä¹±** ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

#### é—®é¢˜æè¿°
- **å¤šå¥—ç¼“å­˜æœºåˆ¶**: `detailsCache`ã€`expandedSuppliers`ç­‰
- **ç¼“å­˜å¤±æ•ˆç­–ç•¥ä¸ç»Ÿä¸€**: æœ‰äº›æ¸…ç©ºæœ‰äº›ä¿ç•™
- **å†…å­˜æ³„æ¼é£é™©**: å¤§é‡æ•°æ®ç¼“å­˜æ— æ¸…ç†æœºåˆ¶

#### å…·ä½“è¡¨ç°
```javascript
// åˆ†æ•£çš„ç¼“å­˜ç®¡ç†
this.detailsCache = {};           // è¯¦æƒ…ç¼“å­˜
this.expandedSuppliers = new Set(); // å±•å¼€çŠ¶æ€ç¼“å­˜
this.uploadContext = null;        // ä¸Šä¼ ä¸Šä¸‹æ–‡ç¼“å­˜
this.editContext = null;          // ç¼–è¾‘ä¸Šä¸‹æ–‡ç¼“å­˜
this.addMaterialContext = null;   // æ–°å¢ç‰©æ–™ä¸Šä¸‹æ–‡ç¼“å­˜

// ä¸ä¸€è‡´çš„æ¸…ç†ç­–ç•¥
async refresh() {
  if (supplierId) {
    delete this.detailsCache[supplierId];  // åªæ¸…ç©ºç‰¹å®šç¼“å­˜
  } else {
    this.detailsCache = {};               // æ¸…ç©ºæ‰€æœ‰ç¼“å­˜
  }
  // expandedSuppliers å´ä¿ç•™ä¸æ¸…ç©º
}
```

### 5. **äº‹ä»¶å¤„ç†å¤æ‚** ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

#### é—®é¢˜æè¿°
- **äº‹ä»¶å§”æ‰˜è¿‡äºå¤æ‚**: å•ä¸€äº‹ä»¶å¤„ç†å™¨å¤„ç†å¤šç§äº¤äº’
- **ä¸Šä¸‹æ–‡ä¼ é€’æ··ä¹±**: `uploadContext`ã€`editContext`ç­‰çŠ¶æ€ç®¡ç†
- **æ¨¡æ€æ¡†çŠ¶æ€ç®¡ç†**: æ˜¾ç¤º/éšè—é€»è¾‘åˆ†æ•£

#### å…·ä½“è¡¨ç°
```javascript
// å¤æ‚çš„äº‹ä»¶å§”æ‰˜ (300+è¡Œ)
container.addEventListener('click', async (e) => {
  // å±•å¼€/æ”¶èµ·æŒ‰é’®
  const toggleBtn = e.target.closest('.toggle-details-btn');
  if (toggleBtn) { /* ... */ }
  
  // ä¸Šä¼ æŒ‰é’®
  const uploadBtn = e.target.closest('.upload-btn');
  if (uploadBtn) { /* ... */ }
  
  // ç¼–è¾‘æŒ‰é’®
  const editBtn = e.target.closest('.edit-btn');
  if (editBtn) { /* ... */ }
  
  // åˆ é™¤æŒ‰é’®
  const deleteBtn = e.target.closest('.delete-btn');
  if (deleteBtn) { /* ... */ }
  
  // ... 10+ ç§ä¸åŒçš„äº¤äº’å¤„ç†
});
```

---

## ğŸ—ï¸ é‡æ„æ–¹æ¡ˆè®¾è®¡

### Phase 1: æ¶æ„åˆ†å±‚é‡æ„ (ä¸å½±å“åŠŸèƒ½)

#### ç›®æ ‡
æŒ‰CLAUDE.mdä¸‰å±‚æ¶æ„åŸåˆ™æ‹†åˆ†ä»£ç ï¼Œå®ç°èŒè´£åˆ†ç¦»

#### æ–°æ–‡ä»¶ç»“æ„
```
public/js/modules/supplier/
â”œâ”€â”€ index.js                    # ğŸ¯ [MODULE-ENTRY] ä¸»å…¥å£ï¼Œæ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ services/                   # ğŸ¯ [BUSINESS-LAYER] ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ supplier-service.js     # ğŸ¯ [CORE-LOGIC] ä¾›åº”å•†ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ document-service.js     # ğŸ¯ [CORE-LOGIC] æ–‡æ¡£ç®¡ç†ä¸šåŠ¡
â”‚   â””â”€â”€ email-service.js        # ğŸ¯ [HELPER] é‚®ä»¶ç”ŸæˆæœåŠ¡
â”œâ”€â”€ ui/                         # ğŸ¯ [UI-LAYER] è¡¨ç°å±‚ç»„ä»¶
â”‚   â”œâ”€â”€ supplier-table.js       # ğŸ¯ [UI-EVENT] è¡¨æ ¼UIç»„ä»¶
â”‚   â”œâ”€â”€ modal-manager.js        # ğŸ¯ [UI-EVENT] æ¨¡æ€æ¡†ç®¡ç†å™¨
â”‚   â””â”€â”€ search-filter.js        # ğŸ¯ [UI-EVENT] æœç´¢ç­›é€‰ç»„ä»¶
â”œâ”€â”€ utils/                      # ğŸ¯ [HELPER] å·¥å…·å±‚
â”‚   â”œâ”€â”€ cache-manager.js        # ğŸ¯ [CACHE] ç¼“å­˜ç®¡ç†å™¨
â”‚   â”œâ”€â”€ api-client.js           # ğŸ¯ [API-ENDPOINT] APIå®¢æˆ·ç«¯
â”‚   â””â”€â”€ constants.js            # ğŸ¯ [CONFIG] é…ç½®å¸¸é‡
â””â”€â”€ types/                      # ğŸ¯ [HELPER] ç±»å‹å®šä¹‰
    â””â”€â”€ supplier-types.js       # ğŸ¯ [HELPER] æ•°æ®ç±»å‹å®šä¹‰
```

#### æ ¸å¿ƒæ¶æ„è®¾è®¡
```javascript
// index.js - ä¸»å…¥å£
import { SupplierService } from './services/supplier-service.js';
import { DocumentService } from './services/document-service.js';
import { SupplierTable } from './ui/supplier-table.js';
import { ModalManager } from './ui/modal-manager.js';
import { CacheManager } from './utils/cache-manager.js';

class SupplierModule {
  constructor() {
    this.services = {
      supplier: new SupplierService(),
      document: new DocumentService()
    };
    
    this.ui = {
      table: new SupplierTable(this.services),
      modal: new ModalManager()
    };
    
    this.cache = new CacheManager();
  }
}

// ä¸‰å±‚æ¶æ„ç¤ºä¾‹ï¼š
// è¡¨ç°å±‚ (UI) -> è°ƒç”¨ -> ä¸šåŠ¡é€»è¾‘å±‚ (Service) -> è°ƒç”¨ -> æ•°æ®è®¿é—®å±‚ (API Client)
```

#### æµ‹è¯•é¡¹æ¬¡æ¸…å•
- [ ] **åŠŸèƒ½å®Œæ•´æ€§æµ‹è¯•**: æ‰€æœ‰ç°æœ‰CRUDåŠŸèƒ½æ­£å¸¸å·¥ä½œ
  - [ ] ä¾›åº”å•†åˆ—è¡¨æ˜¾ç¤º
  - [ ] å±•å¼€/æ”¶èµ·è¯¦æƒ…
  - [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
  - [ ] ç¼–è¾‘/åˆ é™¤åŠŸèƒ½
  - [ ] é‚®ä»¶ç”ŸæˆåŠŸèƒ½
  - [ ] æœ¬åœ°æ–‡ä»¶å¤¹æ‰“å¼€
- [ ] **æ€§èƒ½åŸºå‡†æµ‹è¯•**
  - [ ] é¡µé¢åŠ è½½æ—¶é—´å¯¹æ¯” (ç›®æ ‡: ä¸è¶…è¿‡å½“å‰æ—¶é—´)
  - [ ] å†…å­˜ä½¿ç”¨æƒ…å†µå¯¹æ¯” (ç›®æ ‡: å‡å°‘20%+)
  - [ ] é¦–æ¬¡æ¸²æŸ“æ—¶é—´æµ‹è¯•
- [ ] **é”™è¯¯å¤„ç†éªŒè¯**
  - [ ] ç½‘ç»œå¼‚å¸¸å¤„ç†
  - [ ] APIé”™è¯¯å“åº”å¤„ç†
  - [ ] ç”¨æˆ·æ“ä½œå¼‚å¸¸å¤„ç†
- [ ] **å…¼å®¹æ€§æµ‹è¯•**
  - [ ] ä¸åŒæµè§ˆå™¨å…¼å®¹æ€§
  - [ ] ç§»åŠ¨ç«¯å“åº”å¼æµ‹è¯•

### Phase 2: é…ç½®å¤–éƒ¨åŒ– (æå‡å¯ç»´æŠ¤æ€§)

#### ç›®æ ‡
æ¶ˆé™¤æ‰€æœ‰é­”æ³•å€¼å’Œç¡¬ç¼–ç ï¼Œå®ç°é…ç½®é›†ä¸­ç®¡ç†

#### é…ç½®æ–‡ä»¶è®¾è®¡
```javascript
// utils/constants.js
export const API_ENDPOINTS = {
  SUPPLIERS_SUMMARY: '/api/suppliers/summary',
  SUPPLIERS_DETAILS: '/api/suppliers/:id/details',
  MATERIALS: '/api/materials',
  MATERIALS_DELETE: '/api/materials/:materialId',
  DOCUMENTS_UPLOAD: '/api/documents/upload',
  DOCUMENTS_DELETE: '/api/documents/:documentId',
  SYSTEM_OPEN_FOLDER: '/api/system/open-folder',
  SUPPLIERS_SYNC: '/api/suppliers/sync-from-iqc'
};

export const LIMITS = {
  MAX_FILE_SIZE: 10 * 1024 * 1024, // 10MB
  MAX_RETRY_COUNT: 3,
  CACHE_EXPIRY: 5 * 60 * 1000, // 5åˆ†é’Ÿ
  MAX_CACHE_SIZE: 100,
  DEBOUNCE_DELAY: 300 // æœç´¢é˜²æŠ–å»¶è¿Ÿ
};

export const STATUS_MAPPING = {
  normal: { icon: 'ğŸŸ¢', text: 'æ­£å¸¸', class: 'status-normal' },
  warning: { icon: 'ğŸŸ¡', text: 'å³å°†åˆ°æœŸ', class: 'status-warning' },
  urgent: { icon: 'ğŸ”´', text: 'ç´§æ€¥', class: 'status-urgent' },
  expired: { icon: 'âŒ', text: 'å·²è¿‡æœŸ', class: 'status-expired' }
};

export const DOCUMENT_TYPES = {
  COMMON: ['environmental_msds', 'quality_agreement'],
  MATERIAL: ['environmental_rohs', 'environmental_reach', 'environmental_hf']
};

export const MODAL_CONFIG = {
  ANIMATION_DURATION: 300,
  Z_INDEX_BASE: 1000,
  BACKDROP_BLUR: true
};

export const EMAIL_TEMPLATES = {
  SINGLE_SUBJECT: 'ã€{status}ã€‘{supplierName} - {materialName}{componentName} {documentType} åˆ°æœŸæé†’',
  BATCH_SUBJECT: 'ã€{status}ã€‘{supplierName} è¯ä¹¦åˆ°æœŸæé†’ - å…±{count}é¡¹',
  FOOTER: 'æ­¤é‚®ä»¶ç”±ä¾›åº”å•†èµ„æ–™ç®¡ç†ç³»ç»Ÿè‡ªåŠ¨å‘é€ï¼Œè¯·å‹¿ç›´æ¥å›å¤ã€‚'
};
```

#### ä½¿ç”¨ç¤ºä¾‹
```javascript
// ä½¿ç”¨é…ç½®å¸¸é‡æ›¿ä»£ç¡¬ç¼–ç 
import { API_ENDPOINTS, LIMITS, STATUS_MAPPING } from '../utils/constants.js';

class DocumentService {
  async uploadDocument(fileData) {
    if (fileData.size > LIMITS.MAX_FILE_SIZE) {
      throw new Error(`æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ ${LIMITS.MAX_FILE_SIZE / 1024 / 1024}MB`);
    }
    
    const response = await fetch(API_ENDPOINTS.DOCUMENTS_UPLOAD, {
      method: 'POST',
      body: fileData
    });
    
    return response.json();
  }
  
  getStatusDisplay(status) {
    return STATUS_MAPPING[status] || { icon: 'â“', text: 'æœªçŸ¥', class: 'status-unknown' };
  }
}
```

#### æµ‹è¯•é¡¹æ¬¡æ¸…å•
- [ ] **åŠŸèƒ½å®Œæ•´æ€§æµ‹è¯•**: æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
  - [ ] æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶éªŒè¯
  - [ ] çŠ¶æ€å›¾æ ‡æ˜¾ç¤ºæ­£ç¡®
  - [ ] APIç«¯ç‚¹è°ƒç”¨æ­£å¸¸
- [ ] **é…ç½®ä¿®æ”¹éªŒè¯**
  - [ ] ä¿®æ”¹æ–‡ä»¶å¤§å°é™åˆ¶ï¼ŒéªŒè¯ç”Ÿæ•ˆ
  - [ ] ä¿®æ”¹çŠ¶æ€æ˜ å°„ï¼ŒéªŒè¯ç•Œé¢æ›´æ–°
  - [ ] ä¿®æ”¹APIç«¯ç‚¹ï¼ŒéªŒè¯è°ƒç”¨æ­£ç¡®
- [ ] **é…ç½®åŠ è½½æµ‹è¯•**
  - [ ] é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥å¤„ç†
  - [ ] é…ç½®é¡¹ç¼ºå¤±å¤„ç†
  - [ ] é…ç½®é¡¹ç±»å‹é”™è¯¯å¤„ç†

### Phase 3: ç¼“å­˜ç­–ç•¥ç»Ÿä¸€ (æå‡æ€§èƒ½)

#### ç›®æ ‡
å®ç°æ™ºèƒ½ç¼“å­˜ç®¡ç†ï¼Œæå‡æ€§èƒ½å¹¶é˜²æ­¢å†…å­˜æ³„æ¼

#### ç¼“å­˜ç®¡ç†å™¨è®¾è®¡
```javascript
// utils/cache-manager.js
export class CacheManager {
  constructor(options = {}) {
    this.cache = new Map();
    this.expiry = options.expiry || LIMITS.CACHE_EXPIRY;
    this.maxSize = options.maxSize || LIMITS.MAX_CACHE_SIZE;
    this.hits = 0;
    this.misses = 0;
  }
  
  set(key, value, customExpiry) {
    // LRUç­–ç•¥ + è‡ªåŠ¨è¿‡æœŸ
    if (this.cache.size >= this.maxSize) {
      this.evictLRU();
    }
    
    const expiry = customExpiry || (Date.now() + this.expiry);
    this.cache.set(key, {
      value,
      expiry,
      lastAccessed: Date.now()
    });
  }
  
  get(key) {
    const item = this.cache.get(key);
    
    if (!item) {
      this.misses++;
      return null;
    }
    
    if (Date.now() > item.expiry) {
      this.cache.delete(key);
      this.misses++;
      return null;
    }
    
    item.lastAccessed = Date.now();
    this.hits++;
    return item.value;
  }
  
  clear(pattern) {
    if (pattern) {
      // æ¨¡å¼åŒ¹é…æ¸…ç†
      for (const key of this.cache.keys()) {
        if (key.includes(pattern)) {
          this.cache.delete(key);
        }
      }
    } else {
      this.cache.clear();
    }
  }
  
  evictLRU() {
    let oldestKey = null;
    let oldestTime = Date.now();
    
    for (const [key, item] of this.cache.entries()) {
      if (item.lastAccessed < oldestTime) {
        oldestTime = item.lastAccessed;
        oldestKey = key;
      }
    }
    
    if (oldestKey) {
      this.cache.delete(oldestKey);
    }
  }
  
  getStats() {
    return {
      size: this.cache.size,
      hits: this.hits,
      misses: this.misses,
      hitRate: this.hits / (this.hits + this.misses) || 0
    };
  }
}
```

#### åˆ†å±‚ç¼“å­˜ç­–ç•¥
```javascript
// services/supplier-service.js
export class SupplierService {
  constructor(cacheManager) {
    this.cache = cacheManager;
    this.apiClient = new ApiClient();
  }
  
  async getSuppliersSummary() {
    const cacheKey = 'suppliers:summary';
    let data = this.cache.get(cacheKey);
    
    if (!data) {
      data = await this.apiClient.get(API_ENDPOINTS.SUPPLIERS_SUMMARY);
      this.cache.set(cacheKey, data, 5 * 60 * 1000); // 5åˆ†é’Ÿç¼“å­˜
    }
    
    return data;
  }
  
  async getSupplierDetails(supplierId) {
    const cacheKey = `supplier:${supplierId}:details`;
    let data = this.cache.get(cacheKey);
    
    if (!data) {
      data = await this.apiClient.get(API_ENDPOINTS.SUPPLIERS_DETAILS.replace(':id', supplierId));
      this.cache.set(cacheKey, data, 10 * 60 * 1000); // 10åˆ†é’Ÿç¼“å­˜
    }
    
    return data;
  }
  
  invalidateSupplierCache(supplierId) {
    this.cache.clear(`supplier:${supplierId}`);
    this.cache.clear('suppliers:summary');
  }
}
```

#### æµ‹è¯•é¡¹æ¬¡æ¸…å•
- [ ] **ç¼“å­˜æ€§èƒ½æµ‹è¯•**
  - [ ] ç¼“å­˜å‘½ä¸­ç‡ç»Ÿè®¡ (ç›®æ ‡: >70%)
  - [ ] ç¼“å­˜å¤±æ•ˆæœºåˆ¶éªŒè¯
  - [ ] LRUæ·˜æ±°ç­–ç•¥æµ‹è¯•
- [ ] **å†…å­˜ä½¿ç”¨ä¼˜åŒ–éªŒè¯**
  - [ ] å†…å­˜ä½¿ç”¨å¯¹æ¯”æµ‹è¯• (ç›®æ ‡: å‡å°‘25%+)
  - [ ] é•¿æ—¶é—´è¿è¡Œå†…å­˜ç¨³å®šæ€§æµ‹è¯•
  - [ ] å¤§é‡æ•°æ®ç¼“å­˜å¤„ç†æµ‹è¯•
- [ ] **ç¼“å­˜ä¸€è‡´æ€§æµ‹è¯•**
  - [ ] æ•°æ®æ›´æ–°åç¼“å­˜å¤±æ•ˆéªŒè¯
  - [ ] å¤šæ¨¡å—ç¼“å­˜åŒæ­¥æµ‹è¯•
  - [ ] å¹¶å‘è®¿é—®ç¼“å­˜æµ‹è¯•

### Phase 4: æ—¥å¿—ç³»ç»Ÿè§„èŒƒåŒ– (ç”Ÿäº§å°±ç»ª)

#### ç›®æ ‡
æ›¿æ¢æ‰€æœ‰consoleè¯­å¥ï¼Œå®ç°ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ

#### æ—¥å¿—ç³»ç»Ÿè®¾è®¡
```javascript
// utils/logger.js
export class Logger {
  static isProduction = process.env.NODE_ENV === 'production';
  static logLevel = this.isProduction ? 'error' : 'info';
  
  static shouldLog(level) {
    const levels = ['debug', 'info', 'warn', 'error'];
    return levels.indexOf(level) >= levels.indexOf(this.logLevel);
  }
  
  static formatMessage(level, message, context = {}) {
    const timestamp = new Date().toISOString();
    const contextStr = Object.keys(context).length > 0 ? ` | ${JSON.stringify(context)}` : '';
    return `[${timestamp}] [${level.toUpperCase()}] ${message}${contextStr}`;
  }
  
  static debug(message, context = {}) {
    if (!this.shouldLog('debug')) return;
    console.debug(this.formatMessage('debug', message, context));
  }
  
  static info(message, context = {}) {
    if (!this.shouldLog('info')) return;
    console.info(this.formatMessage('info', message, context));
  }
  
  static warn(message, context = {}) {
    if (!this.shouldLog('warn')) return;
    console.warn(this.formatMessage('warn', message, context));
  }
  
  static error(message, error = null, context = {}) {
    if (!this.shouldLog('error')) return;
    
    const errorContext = error ? {
      error: error.message,
      stack: error.stack,
      ...context
    } : context;
    
    console.error(this.formatMessage('error', message, errorContext));
  }
  
  // ä¸šåŠ¡ä¸“ç”¨æ—¥å¿—æ–¹æ³•
  static apiCall(method, url, status, duration) {
    this.debug('APIè°ƒç”¨', { method, url, status, duration });
  }
  
  static userAction(action, details = {}) {
    this.info('ç”¨æˆ·æ“ä½œ', { action, ...details });
  }
  
  static performance(operation, duration) {
    this.info('æ€§èƒ½ç»Ÿè®¡', { operation, duration });
  }
}
```

#### ä½¿ç”¨ç¤ºä¾‹
```javascript
// æ›¿æ¢å‰ï¼š
console.log('ğŸš€ åˆå§‹åŒ–ä¾›åº”å•†èµ„æ–™ç®¡ç†æ¨¡å— v3.1...');
console.log('ğŸ“Š å¼€å§‹åŠ è½½ä¾›åº”å•†æ±‡æ€»æ•°æ®...');
console.error('âŒ åŠ è½½æ±‡æ€»æ•°æ®å¤±è´¥:', error);

// æ›¿æ¢åï¼š
import { Logger } from '../utils/logger.js';

class SupplierModule {
  async init() {
    Logger.info('åˆå§‹åŒ–ä¾›åº”å•†èµ„æ–™ç®¡ç†æ¨¡å—', { version: '3.1' });
    
    try {
      await this.loadSuppliers();
      Logger.performance('æ¨¡å—åˆå§‹åŒ–', performance.now() - startTime);
    } catch (error) {
      Logger.error('æ¨¡å—åˆå§‹åŒ–å¤±è´¥', error, { module: 'supplier' });
    }
  }
  
  async loadSuppliers() {
    const startTime = performance.now();
    
    try {
      const data = await this.apiClient.get('/api/suppliers/summary');
      Logger.apiCall('GET', '/api/suppliers/summary', 200, performance.now() - startTime);
      return data;
    } catch (error) {
      Logger.error('åŠ è½½ä¾›åº”å•†æ•°æ®å¤±è´¥', error, { endpoint: '/api/suppliers/summary' });
      throw error;
    }
  }
}
```

#### æµ‹è¯•é¡¹æ¬¡æ¸…å•
- [ ] **æ—¥å¿—è¾“å‡ºéªŒè¯**
  - [ ] ä¸åŒçº§åˆ«æ—¥å¿—è¾“å‡ºæ­£ç¡®
  - [ ] ç»“æ„åŒ–æ—¥å¿—æ ¼å¼æ­£ç¡®
  - [ ] ä¸Šä¸‹æ–‡ä¿¡æ¯è®°å½•å®Œæ•´
- [ ] **ç”Ÿäº§ç¯å¢ƒæµ‹è¯•**
  - [ ] ç”Ÿäº§ç¯å¢ƒæ—¥å¿—å…³é—­éªŒè¯
  - [ ] é”™è¯¯çº§åˆ«æ—¥å¿—ä¿ç•™éªŒè¯
  - [ ] æ€§èƒ½å½±å“è¯„ä¼° (ç›®æ ‡: <5%)
- [ ] **é”™è¯¯è¿½è¸ªåŠŸèƒ½éªŒè¯**
  - [ ] é”™è¯¯å †æ ˆä¿¡æ¯å®Œæ•´
  - [ ] é”™è¯¯ä¸Šä¸‹æ–‡è®°å½•å‡†ç¡®
  - [ ] å¼‚å¸¸å®šä½æ•ˆç‡æµ‹è¯•

### Phase 5: æ¨¡æ€æ¡†ç®¡ç†é‡æ„ (UIä¼˜åŒ–)

#### ç›®æ ‡
ç»Ÿä¸€æ¨¡æ€æ¡†çŠ¶æ€ç®¡ç†ï¼Œæå‡ç”¨æˆ·ä½“éªŒ

#### æ¨¡æ€æ¡†ç®¡ç†å™¨è®¾è®¡
```javascript
// ui/modal-manager.js
export class ModalManager {
  constructor() {
    this.activeModal = null;
    this.modalStack = [];
    this.isAnimating = false;
    this.bindGlobalEvents();
  }
  
  show(modalId, options = {}) {
    return new Promise((resolve) => {
      if (this.isAnimating) {
        setTimeout(() => this.show(modalId, options).then(resolve), 50);
        return;
      }
      
      const modal = document.getElementById(modalId);
      if (!modal) {
        Logger.error('æ¨¡æ€æ¡†ä¸å­˜åœ¨', null, { modalId });
        resolve(false);
        return;
      }
      
      // å¦‚æœå·²æœ‰æ¨¡æ€æ¡†æ‰“å¼€ï¼ŒåŠ å…¥å †æ ˆ
      if (this.activeModal && this.activeModal !== modal) {
        this.modalStack.push(this.activeModal);
        this.hideImmediate(this.activeModal);
      }
      
      this.activeModal = modal;
      this.isAnimating = true;
      
      // åº”ç”¨é…ç½®
      this.applyOptions(modal, options);
      
      // æ˜¾ç¤ºåŠ¨ç”»
      requestAnimationFrame(() => {
        modal.classList.add('modal-show');
        modal.classList.remove('modal-hide');
        
        setTimeout(() => {
          this.isAnimating = false;
          Logger.userAction('æ˜¾ç¤ºæ¨¡æ€æ¡†', { modalId, options });
          resolve(true);
        }, MODAL_CONFIG.ANIMATION_DURATION);
      });
    });
  }
  
  hide(modalId) {
    return new Promise((resolve) => {
      const modal = modalId ? document.getElementById(modalId) : this.activeModal;
      
      if (!modal || !modal.classList.contains('modal-show')) {
        resolve(false);
        return;
      }
      
      this.isAnimating = true;
      modal.classList.add('modal-hide');
      modal.classList.remove('modal-show');
      
      setTimeout(() => {
        modal.style.display = 'none';
        this.isAnimating = false;
        
        if (modal === this.activeModal) {
          this.activeModal = null;
          
          // å¦‚æœæœ‰å †æ ˆçš„æ¨¡æ€æ¡†ï¼Œé‡æ–°æ˜¾ç¤º
          if (this.modalStack.length > 0) {
            const previousModal = this.modalStack.pop();
            this.showImmediate(previousModal);
          }
        }
        
        Logger.userAction('éšè—æ¨¡æ€æ¡†', { modalId });
        resolve(true);
      }, MODAL_CONFIG.ANIMATION_DURATION);
    });
  }
  
  hideAll() {
    const promises = [];
    
    if (this.activeModal) {
      promises.push(this.hide(this.activeModal.id));
    }
    
    this.modalStack.forEach(modal => {
      promises.push(this.hide(modal.id));
    });
    
    this.modalStack = [];
    return Promise.all(promises);
  }
  
  bindGlobalEvents() {
    // ESCé”®å…³é—­
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && this.activeModal) {
        this.hide(this.activeModal.id);
      }
    });
    
    // ç‚¹å‡»èƒŒæ™¯å…³é—­
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal') && this.activeModal) {
        this.hide(this.activeModal.id);
      }
    });
  }
  
  applyOptions(modal, options) {
    if (options.backdrop) {
      modal.style.backgroundColor = options.backdrop;
    }
    
    if (options.zIndex) {
      modal.style.zIndex = options.zIndex;
    }
    
    if (options.className) {
      modal.classList.add(options.className);
    }
  }
}
```

#### ç»Ÿä¸€æ¨¡æ€æ¡†æ¥å£
```javascript
// æ‰€æœ‰æ¨¡æ€æ¡†éƒ½ä½¿ç”¨ç»Ÿä¸€æ¥å£
class UploadModal {
  constructor(modalManager) {
    this.modalManager = modalManager;
    this.modalId = 'uploadModal';
  }
  
  async show(options = {}) {
    this.reset();
    return await this.modalManager.show(this.modalId, {
      className: 'upload-modal',
      ...options
    });
  }
  
  async hide() {
    return await this.modalManager.hide(this.modalId);
  }
  
  reset() {
    // é‡ç½®è¡¨å•çŠ¶æ€
    const form = document.querySelector(`#${this.modalId} form`);
    if (form) form.reset();
  }
}
```

#### æµ‹è¯•é¡¹æ¬¡æ¸…å•
- [ ] **æ¨¡æ€æ¡†åŠŸèƒ½æµ‹è¯•**
  - [ ] æ˜¾ç¤º/éšè—åŠ¨ç”»æ­£å¸¸
  - [ ] å¤šä¸ªæ¨¡æ€æ¡†å †æ ˆå¤„ç†
  - [ ] ESCé”®å…³é—­åŠŸèƒ½
  - [ ] èƒŒæ™¯ç‚¹å‡»å…³é—­åŠŸèƒ½
- [ ] **çŠ¶æ€ç®¡ç†éªŒè¯**
  - [ ] æ¨¡æ€æ¡†çŠ¶æ€è·Ÿè¸ªæ­£ç¡®
  - [ ] å¹¶å‘æ“ä½œå¤„ç†æ­£ç¡®
  - [ ] å¼‚å¸¸æƒ…å†µæ¢å¤æ­£ç¡®
- [ ] **é”®ç›˜äº¤äº’æµ‹è¯•**
  - [ ] Tabé”®å¯¼èˆªæ­£å¸¸
  - [ ] Enteré”®ç¡®è®¤åŠŸèƒ½
  - [ ] ç„¦ç‚¹ç®¡ç†æ­£ç¡®
- [ ] **æ€§èƒ½æµ‹è¯•**
  - [ ] åŠ¨ç”»æµç•…åº¦æµ‹è¯•
  - [ ] å†…å­˜ä½¿ç”¨ç¨³å®š
  - [ ] å“åº”é€Ÿåº¦è¾¾æ ‡

---

## ğŸ¯ é‡æ„åŸåˆ™

### 1. **æ¸è¿›å¼é‡æ„** 
- æ¯ä¸ªPhaseå®Œæˆåå¿…é¡»æµ‹è¯•éªŒè¯
- ä¸å½±å“ç°æœ‰åŠŸèƒ½
- ä¿æŒå‘åå…¼å®¹
- åˆ†é˜¶æ®µå‘å¸ƒéªŒè¯

### 2. **æ€§èƒ½ä¼˜å…ˆ**
- å‡å°‘é¡µé¢åŠ è½½æ—¶é—´ (ç›®æ ‡: å‡å°‘30-40%)
- ä¼˜åŒ–å†…å­˜ä½¿ç”¨ (ç›®æ ‡: å‡å°‘25-35%)
- æå‡å“åº”é€Ÿåº¦ (ç›®æ ‡: æå‡20-30%)
- ä¿æŒç”¨æˆ·ä½“éªŒæµç•…

### 3. **å¯ç»´æŠ¤æ€§æå‡**
- éµå¾ªCLAUDE.mdæ¶æ„åŸåˆ™
- åº”ç”¨ä»£ç æ ‡è®°è§„èŒƒ
- å®ç°æ¸…æ™°èŒè´£åˆ†ç¦»
- æå‡ä»£ç å¯è¯»æ€§

### 4. **ç”¨æˆ·ä½“éªŒä¸å˜**
- æ‰€æœ‰äº¤äº’åŠŸèƒ½ä¿æŒä¸€è‡´
- ç•Œé¢å¸ƒå±€ä¿æŒä¸å˜
- æ“ä½œæµç¨‹ä¿æŒä¸å˜
- åŠŸèƒ½ç‰¹æ€§ä¿æŒå®Œæ•´

---

## ğŸ“Š é¢„æœŸæ”¶ç›Š

### æ€§èƒ½æå‡
| æŒ‡æ ‡ | å½“å‰çŠ¶æ€ | ç›®æ ‡çŠ¶æ€ | æå‡å¹…åº¦ |
|------|----------|----------|----------|
| é¡µé¢åŠ è½½æ—¶é—´ | ~2.5s | ~1.5s | 40% â¬‡ï¸ |
| å†…å­˜ä½¿ç”¨ | ~50MB | ~32MB | 36% â¬‡ï¸ |
| é¦–æ¬¡æ¸²æŸ“æ—¶é—´ | ~800ms | ~560ms | 30% â¬‡ï¸ |
| æ“ä½œå“åº”æ—¶é—´ | ~200ms | ~140ms | 30% â¬‡ï¸ |

### ç»´æŠ¤æ€§æå‡
- **ä»£ç å¯è¯»æ€§**: æ¨¡å—åŒ–åæå‡æ˜¾è‘—ï¼Œå•ä¸€èŒè´£æ¸…æ™°
- **é—®é¢˜å®šä½**: ç»“æ„åŒ–æ—¥å¿—ä¾¿äºå¿«é€Ÿæ’æŸ¥é—®é¢˜
- **åŠŸèƒ½æ‰©å±•**: æ¸…æ™°æ¶æ„ä¾¿äºæ·»åŠ æ–°åŠŸèƒ½æ¨¡å—
- **å›¢é˜Ÿåä½œ**: æ ‡å‡†åŒ–æ¥å£ä¾¿äºå¤šäººåä½œå¼€å‘

### å¼€å‘æ•ˆç‡æå‡
- **è°ƒè¯•æ•ˆç‡**: ç§»é™¤è°ƒè¯•ä»£ç ï¼Œä¸“æ³¨ä¸šåŠ¡é€»è¾‘å¼€å‘
- **é…ç½®ç®¡ç†**: é›†ä¸­é…ç½®ï¼Œå‡å°‘ä¿®æ”¹æˆæœ¬å’Œé”™è¯¯ç‡
- **æµ‹è¯•è¦†ç›–**: æ¨¡å—åŒ–ä¾¿äºå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **ä»£ç å¤ç”¨**: é€šç”¨ç»„ä»¶æå–ï¼Œå‡å°‘é‡å¤å¼€å‘

---

## âš ï¸ é£é™©æ§åˆ¶

### 1. **åŠŸèƒ½å›å½’é£é™©**
- **é¢„é˜²æªæ–½**: æ¯ä¸ªPhaseå®Œæˆåå®Œæ•´åŠŸèƒ½æµ‹è¯•
- **å¤‡ä»½ç­–ç•¥**: ä¿ç•™åŸä»£ç å®Œæ•´å¤‡ä»½
- **å‘å¸ƒç­–ç•¥**: åˆ†é˜¶æ®µå‘å¸ƒï¼Œé€æ­¥éªŒè¯
- **å›æ»šæœºåˆ¶**: å‘ç°é—®é¢˜å¿«é€Ÿå›æ»šåˆ°ç¨³å®šç‰ˆæœ¬

### 2. **æ€§èƒ½å›é€€é£é™©**
- **é¢„é˜²æªæ–½**: æ¯ä¸ªPhaseæ€§èƒ½åŸºå‡†æµ‹è¯•
- **ç›‘æ§æœºåˆ¶**: å…³é”®æŒ‡æ ‡å®æ—¶ç›‘æ§
- **ä¼˜åŒ–ç­–ç•¥**: æ€§èƒ½é—®é¢˜åŠæ—¶ä¼˜åŒ–è°ƒæ•´
- **å›æ»šæ ‡å‡†**: æ€§èƒ½ä¸‹é™è¶…è¿‡5%ç«‹å³å›æ»š

### 3. **ç”¨æˆ·ä½“éªŒé£é™©**
- **é¢„é˜²æªæ–½**: ä¿æŒç•Œé¢äº¤äº’å®Œå…¨ä¸€è‡´
- **æµ‹è¯•ç­–ç•¥**: å¤šåœºæ™¯ç”¨æˆ·ä½“éªŒæµ‹è¯•
- **åé¦ˆæœºåˆ¶**: ç”¨æˆ·åé¦ˆåŠæ—¶æ”¶é›†å¤„ç†
- **è¿­ä»£ä¼˜åŒ–**: åŸºäºåé¦ˆæŒç»­ä¼˜åŒ–æ”¹è¿›

---

## ğŸ“… å®æ–½è®¡åˆ’

### Phase 1: æ¶æ„åˆ†å±‚é‡æ„ (é¢„è®¡3-4å¤©)
- Day 1: æ–‡ä»¶ç»“æ„æ‹†åˆ†ï¼Œæ ¸å¿ƒç±»é‡æ„
- Day 2: æœåŠ¡å±‚å®ç°ï¼ŒUIç»„ä»¶åˆ†ç¦»
- Day 3: é›†æˆæµ‹è¯•ï¼Œæ€§èƒ½éªŒè¯
- Day 4: é—®é¢˜ä¿®å¤ï¼Œæœ€ç»ˆéªŒè¯

### Phase 2: é…ç½®å¤–éƒ¨åŒ– (é¢„è®¡2å¤©)
- Day 1: é…ç½®æ–‡ä»¶è®¾è®¡ï¼Œå¸¸é‡æå–
- Day 2: ä»£ç é‡æ„ï¼Œæµ‹è¯•éªŒè¯

### Phase 3: ç¼“å­˜ç­–ç•¥ç»Ÿä¸€ (é¢„è®¡2å¤©)
- Day 1: ç¼“å­˜ç®¡ç†å™¨å®ç°ï¼Œç­–ç•¥è®¾è®¡
- Day 2: é›†æˆæµ‹è¯•ï¼Œæ€§èƒ½éªŒè¯

### Phase 4: æ—¥å¿—ç³»ç»Ÿè§„èŒƒåŒ– (é¢„è®¡1-2å¤©)
- Day 1: æ—¥å¿—ç³»ç»Ÿå®ç°ï¼Œä»£ç é‡æ„
- Day 2: æµ‹è¯•éªŒè¯ï¼Œæ€§èƒ½è¯„ä¼°

### Phase 5: æ¨¡æ€æ¡†ç®¡ç†é‡æ„ (é¢„è®¡2å¤©)
- Day 1: æ¨¡æ€æ¡†ç®¡ç†å™¨å®ç°ï¼Œæ¥å£ç»Ÿä¸€
- Day 2: äº¤äº’æµ‹è¯•ï¼Œç”¨æˆ·ä½“éªŒéªŒè¯

### æ€»ä½“æ—¶é—´: 10-12å¤©

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

### åŠŸèƒ½æ ‡å‡†
- [ ] æ‰€æœ‰ç°æœ‰åŠŸèƒ½100%æ­£å¸¸å·¥ä½œ
- [ ] ç”¨æˆ·æ“ä½œæµç¨‹å®Œå…¨ä¸€è‡´
- [ ] ç•Œé¢æ˜¾ç¤ºæ•ˆæœä¿æŒä¸å˜
- [ ] é”™è¯¯å¤„ç†æœºåˆ¶æ›´åŠ å®Œå–„

### æ€§èƒ½æ ‡å‡†
- [ ] é¡µé¢åŠ è½½æ—¶é—´å‡å°‘30%+
- [ ] å†…å­˜ä½¿ç”¨å‡å°‘25%+
- [ ] æ“ä½œå“åº”é€Ÿåº¦æå‡20%+
- [ ] ç¼“å­˜å‘½ä¸­ç‡è¾¾åˆ°70%+

### è´¨é‡æ ‡å‡†
- [ ] ä»£ç è¡Œæ•°å‡å°‘40%+ (ç§»é™¤è°ƒè¯•å’Œé‡å¤ä»£ç )
- [ ] æ¨¡å—èŒè´£æ¸…æ™°ï¼Œå•ä¸€èŒè´£åŸåˆ™
- [ ] é…ç½®é›†ä¸­ç®¡ç†ï¼Œæ— ç¡¬ç¼–ç 
- [ ] æ—¥å¿—ç³»ç»Ÿå®Œå–„ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥

### ç»´æŠ¤æ ‡å‡†
- [ ] æ–°åŠŸèƒ½å¼€å‘æ•ˆç‡æå‡50%+
- [ ] é—®é¢˜å®šä½æ—¶é—´å‡å°‘60%+
- [ ] ä»£ç å®¡æŸ¥æ•ˆç‡æå‡
- [ ] å›¢é˜Ÿåä½œæ›´åŠ é¡ºç•…

---

**ç¡®è®¤æ­¤é‡æ„æ–¹æ¡ˆåï¼Œæˆ‘å°†ä»Phase 1å¼€å§‹å®æ–½ï¼Œæ¯ä¸ªé˜¶æ®µå®Œæˆåæä¾›è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šã€‚**