========================================
    SQE 数据分析助手 - 使用说明
========================================

📦 项目简介
-----------
SQE 数据分析助手是一款专为 SQE（供应商质量工程师）设计的 IQC 来料检验数据分析工具。
可以快速分析 Excel 检验数据，生成统计报表、趋势图表和供应商排名。


✨ 主要功能
-----------
1. 📊 数据统计分析
   - 总批次数、合格批次、退货批次、特采批次统计
   - 批次合格率计算

2. 📈 周度数据对比
   - 自动对比本周与上周数据
   - 支持自定义时间段对比
   - 显示批次合格率变化

3. 📉 月度趋势分析
   - 月度合格率趋势图
   - 平均合格率明细表
   - 累计数据统计

4. 🏆 供应商排名
   - 供应商良率排名
   - 缺陷类型分布分析
   - 供应商数据筛选

5. 🔍 供应商搜索
   - 快速搜索特定供应商数据
   - 支持模糊匹配


🚀 快速开始
-----------

【方法一：使用便携版（推荐）】

1. 确保文件夹结构如下：
   SQE-Data-Analysis-Assistant-refactored/
   ├── nodejs-portable/          ← 便携版 Node.js（已包含）
   │   ├── node.exe
   │   ├── npm.cmd
   │   └── ...
   ├── server/                    ← 服务器代码
   ├── public/                    ← 前端代码
   ├── start.bat                  ← 启动脚本
   └── package.json

2. 双击运行 start.bat

3. 首次运行会自动安装依赖包（需要几分钟）

4. 浏览器会自动打开 http://localhost:3000

5. 上传 IQC 检验数据 Excel 文件开始分析


【方法二：使用系统 Node.js】

如果没有 nodejs-portable 文件夹，脚本会自动尝试使用系统已安装的 Node.js。

前提条件：
- 已安装 Node.js（推荐 v18 或更高版本）
- 下载地址: https://nodejs.org/


💡 使用提示
-----------

1. Excel 文件要求
   - 支持 .xlsx 和 .xls 格式
   - 必须包含 IQC 检验数据
   - 支持外购和外协两种类型

2. 数据列要求
   - 必需列：送检日期、供应商名称、检验结果、检验措施
   - 可选列：缺陷现象描述

3. 周度统计说明
   - 统计周期：上周五 00:00 至 本周四 23:59
   - 可自定义任意时间段进行对比

4. 停止服务器
   - 在命令行窗口按 Ctrl+C
   - 或直接关闭窗口


📁 分发指南
-----------

如果要将此工具分享给其他人使用，请确保包含以下文件：

必需文件：
✓ start.bat                    ← 启动脚本
✓ package.json                 ← 项目配置
✓ server/                      ← 服务器代码（整个文件夹）
✓ public/                      ← 前端代码（整个文件夹）
✓ nodejs-portable/             ← 便携版 Node.js（整个文件夹）
✓ 使用说明.txt                ← 本文件

可选文件：
○ node_modules/                ← 依赖包（如不包含，首次运行会自动安装）
○ README.md                    ← 开发文档

不需要的文件：
✗ uploads/                     ← 临时上传文件
✗ logs/                        ← 日志文件


❓ 常见问题
-----------

Q: 双击 start.bat 后闪退怎么办？
A: 1. 检查 nodejs-portable 文件夹是否存在
   2. 检查文件夹路径是否包含中文或特殊字符
   3. 右键 start.bat → 以管理员身份运行

Q: 提示 "未找到 Node.js" 怎么办？
A: 1. 确认 nodejs-portable 文件夹在项目根目录
   2. 或者安装系统 Node.js: https://nodejs.org/

Q: 首次运行卡在 "正在安装依赖包" 怎么办？
A: 这是正常现象，首次安装需要下载约 50MB 的依赖包。
   请耐心等待 3-5 分钟。如果网络较慢，可能需要更长时间。

Q: 浏览器没有自动打开怎么办？
A: 手动在浏览器中访问: http://localhost:3000

Q: 上传文件后提示错误怎么办？
A: 1. 检查 Excel 文件格式是否正确
   2. 确认文件包含必需的数据列
   3. 查看服务器窗口的错误提示

Q: 如何更新到新版本？
A: 1. 备份当前文件夹
   2. 用新版本替换 server/ 和 public/ 文件夹
   3. 保留 nodejs-portable 和 node_modules
   4. 重新运行 start.bat


🔧 技术信息
-----------

- 后端: Node.js + Express
- 前端: HTML5 + CSS3 + JavaScript
- Excel 解析: xlsx
- 图表库: Chart.js
- 端口: 3000（可在 server/index.js 中修改）


📞 支持与反馈
-------------

如有问题或建议，请联系开发团队。


========================================
祝您使用愉快！
========================================
