# 月度绩效评价板块实施计划

**创建时间**: 2025-11-25  
**版本**: v1.0  
**目标**: 构建高度可配置的月度供应商绩效评价系统

---

## 🎯 **项目概述**

基于现有的IQC数据架构，构建一个**高度可配置**的月度绩效评价系统，用户可以自定义评分维度和内容，质量相关维度自动提取IQC数据，其他维度支持手动录入或数据导入。

---

## 🏗️ **系统架构设计**

### **数据模型设计**

#### **1. PerformanceTemplate（绩效评价模板）**
```javascript
{
  id: Number,           // 模板ID
  name: String,         // 模板名称
  description: String,  // 模板描述
  isDefault: Boolean,   // 是否默认模板
  dimensions: JSON,     // 维度配置
  createdBy: String,    // 创建者
  createdAt: Date,      // 创建时间
  updatedAt: Date       // 更新时间
}
```

#### **2. PerformanceData（绩效数据记录）**
```javascript
{
  id: Number,           // 记录ID
  templateId: Number,   // 模板ID
  supplierName: String, // 供应商名称
  period: String,       // 评价周期（YYYY-MM）
  dimensionData: JSON,  // 各维度数据
  totalScore: Number,   // 总分
  level: String,        // 评级（A/B/C/D）
  status: String,       // 状态
  createdBy: String,    // 创建者
  createdAt: Date,      // 创建时间
  updatedAt: Date       // 更新时间
}
```

#### **3. PerformanceConfig（评分规则配置）**
```javascript
{
  id: Number,           // 配置ID
  templateId: Number,   // 模板ID
  dimensionName: String, // 维度名称
  weight: Number,       // 权重
  dataSource: String,   // 数据源类型（auto/manual/import）
  extractionRule: JSON, // 提取规则
  scoringRule: JSON,    // 评分规则
  isActive: Boolean,    // 是否启用
  createdAt: Date,      // 创建时间
  updatedAt: Date       // 更新时间
}
```

#### **4. PerformanceScore（评分结果）**
```javascript
{
  id: Number,           // 评分ID
  dataId: Number,       // 数据记录ID
  dimensionName: String, // 维度名称
  rawValue: Number,    // 原始值
  score: Number,        // 得分
  weight: Number,       // 权重
  weightedScore: Number, // 加权得分
  level: String,        // 等级
  createdAt: Date       // 创建时间
}
```

### **核心功能模块**

#### **1. 自定义维度管理**
- **维度类型分类**:
  - **自动维度**: 质量相关（合格率、退货率、PPM等）
  - **手动维度**: 交付、服务、成本等
  - **导入维度**: 外部数据源导入
- **维度配置选项**:
  - 数据源类型选择
  - 权重设置（支持动态调整）
  - 评分方式配置
  - 更新频率设置

#### **2. IQC数据自动提取**
- **数据映射规则**:
  - 合格率 → 质量维度得分
  - 退货率 → 质量维度得分
  - 特采率 → 质量维度得分
  - 不良描述 → 质量问题分析
- **计算公式支持**:
  - 基础运算：加减乘除
  - 条件判断：if-else逻辑
  - 聚合函数：avg、sum、max、min
- **数据验证机制**:
  - 异常值检测
  - 数据完整性校验
  - 逻辑一致性检查

#### **3. 可视化仪表盘**
- **动态图表生成**:
  - 雷达图（根据自定义维度）
  - 趋势图（时间序列）
  - 对比图（供应商横向）
  - 分布图（等级分布）
- **交互功能**:
  - 权重拖拽调整
  - 时间范围筛选
  - 供应商对比选择
  - 数据钻取分析

---

## 🚀 **实施计划**

### **Phase 1: 基础架构 (预计2天)**

#### **任务1.1: 创建绩效相关数据模型**
**文件**: `server/models/PerformanceTemplate.js`, `server/models/PerformanceData.js`, `server/models/PerformanceConfig.js`, `server/models/PerformanceScore.js`

**实施内容**:
- 使用Sequelize定义数据模型
- 设置表关联关系
- 添加数据验证规则
- 创建数据库迁移脚本

#### **任务1.2: 设计自定义维度配置系统**
**文件**: `server/services/performance-config-service.js`

**实施内容**:
- 维度配置CRUD操作
- 模板管理功能
- 配置验证逻辑
- 默认模板初始化

#### **任务1.3: 开发IQC数据自动提取引擎**
**文件**: `server/services/data-extraction-service.js`

**实施内容**:
- IQC数据解析和映射
- 自定义计算公式引擎
- 数据验证和清洗
- 定时任务调度

#### **任务1.4: 建立评分计算框架**
**文件**: `server/services/performance-calculation-service.js`

**实施内容**:
- 评分算法实现
- 权重计算逻辑
- 等级划分规则
- 结果存储机制

### **Phase 2: 前端界面 (预计2天)**

#### **任务2.1: 创建performance.js前端模块**
**文件**: `public/js/modules/performance.js`

**实施内容**:
- 模块初始化和路由
- 状态管理
- API接口封装
- 事件处理机制

#### **任务2.2: 开发维度配置界面**
**文件**: `public/performance-config.html`, `public/css/modules/performance.css`

**实施内容**:
- 维度配置表单
- 拖拽式权重调整
- 模板选择和编辑
- 实时预览功能

#### **任务2.3: 实现动态可视化图表**
**文件**: `public/js/charts-performance.js`

**实施内容**:
- 雷达图组件
- 趋势图组件
- 对比图组件
- 图表交互逻辑

#### **任务2.4: 添加数据录入功能**
**文件**: `public/performance-data.html`

**实施内容**:
- 数据录入表单
- 批量导入功能
- 数据验证界面
- 历史记录查看

### **Phase 3: 高级功能 (预计1天)**

#### **任务3.1: 模板管理系统**
**文件**: `server/services/template-service.js`

**实施内容**:
- 模板CRUD操作
- 模板复制和分享
- 预设模板管理
- 模板导入导出

#### **任务3.2: 批量数据导入功能**
**文件**: `server/services/data-import-service.js`

**实施内容**:
- Excel文件解析
- 数据格式验证
- 批量导入处理
- 错误处理和报告

---

## 💡 **技术实现细节**

### **维度配置示例**
```javascript
{
  "templateName": "综合评价模板",
  "dimensions": [
    {
      "name": "质量合格率",
      "dataSource": "auto",
      "extractionRule": {
        "metric": "passRate",
        "calculation": "(okBatches / totalBatches) * 100",
        "condition": "totalBatches > 0"
      },
      "weight": 40,
      "scoring": {
        "type": "range",
        "ranges": [
          {"min": 95, "max": 100, "score": 100, "level": "A"},
          {"min": 90, "max": 95, "score": 80, "level": "B"},
          {"min": 85, "max": 90, "score": 60, "level": "C"},
          {"min": 0, "max": 85, "score": 40, "level": "D"}
        ]
      }
    },
    {
      "name": "交付及时率",
      "dataSource": "manual",
      "weight": 30,
      "scoring": {
        "type": "grade",
        "grades": [
          {"grade": "A", "score": 100},
          {"grade": "B", "score": 80},
          {"grade": "C", "score": 60},
          {"grade": "D", "score": 40}
        ]
      }
    }
  ]
}
```

### **API接口设计**
```
GET /api/performance/templates          # 获取模板列表
POST /api/performance/templates         # 创建模板
PUT /api/performance/templates/:id      # 更新模板
DELETE /api/performance/templates/:id   # 删除模板

GET /api/performance/configs            # 获取配置列表
POST /api/performance/configs            # 创建配置
PUT /api/performance/configs/:id         # 更新配置

GET /api/performance/data               # 获取绩效数据
POST /api/performance/data               # 创建绩效数据
PUT /api/performance/data/:id            # 更新绩效数据

POST /api/performance/calculate           # 计算绩效评分
GET /api/performance/scores              # 获取评分结果
POST /api/performance/import              # 批量导入数据
```

---

## 🎨 **用户体验设计**

### **界面布局规划**
- **顶部导航**: 模板选择、时间筛选、操作按钮
- **左侧面板**: 维度配置、权重调整
- **中央区域**: 可视化图表展示
- **右侧面板**: 数据详情、历史记录

### **交互设计原则**
- **所见即所得**: 配置变化实时反映
- **拖拽操作**: 直观的权重调整
- **智能提示**: 基于数据的操作建议
- **响应式设计**: 支持多设备访问

---

## 📊 **预期成果**

### **功能成果**
- **高度灵活**: 支持不同行业评价需求
- **数据驱动**: IQC数据自动转化
- **易于使用**: 非技术人员可配置
- **专业可靠**: 符合质量管理标准

### **技术成果**
- **模块化架构**: 易于维护和扩展
- **高性能**: 支持大数据量处理
- **可配置**: 灵活的业务规则配置
- **可扩展**: 支持未来功能扩展

---

## ⚠️ **风险控制**

### **技术风险**
- **数据一致性**: 确保IQC数据与绩效数据同步
- **计算准确性**: 验证评分算法正确性
- **性能优化**: 大数据量时的查询优化

### **业务风险**
- **用户接受度**: 确保配置界面易用性
- **数据质量**: 建立数据验证机制
- **变更管理**: 支持配置变更的版本控制

---

## 📝 **开发日志**

### **2025-11-25**
- 项目启动，完成需求分析和架构设计
- 制定详细实施计划
- 确定技术方案和开发路线图

---

**文档维护**: 本文档将随开发进度持续更新
**最后更新**: 2025-11-25